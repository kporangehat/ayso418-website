{% load wagtailcore_tags %}

<div class="card bg-base-100 shadow-xl">
    <div class="card-body p-6">
        <h2 class="card-title text-lg">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-4 h-4">
                <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5" />
            </svg>
            {{ current_category }}
        </h2>

        <nav aria-label="Resource navigation">
            <ul class="menu menu-sm p-0">
                {% for category in all_categories %}
                    {% if category == current_category and category_pages %}
                        {% for page in category_pages %}
                            <li><a href="{{ page.url }}" class="text-base-content/70">{{ page.title }}</a></li>
                        {% endfor %}
                    {% endif %}
                {% endfor %}
            </ul>
        </nav>
            {% comment %} </div>
        </div>

        <nav aria-label="Resource navigation">
            <ul class="menu menu-sm p-0 space-y-0.5">
                <!-- Categories -->
                {% for category in all_categories %}
                <li>
                    <a href="{% pageurl resources_index %}#{{ category|slugify }}"
                       class="{% if category == current_category %}font-semibold text-primary{% else %}text-base-content/70{% endif %} py-1.5">
                        {{ category }}
                        {% if category == current_category %}
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-3.5 h-3.5 ml-auto">
                                <path fill-rule="evenodd" d="M16.704 4.153a.75.75 0 01.143 1.052l-8 10.5a.75.75 0 01-1.127.075l-4.5-4.5a.75.75 0 011.06-1.06l3.894 3.893 7.48-9.817a.75.75 0 011.05-.143z" clip-rule="evenodd" />
                            </svg>
                        {% endif %}
                    </a>

                    <!-- Show pages if this is the current category -->
                    {% if category == current_category and category_pages %}
                    <ul class="ml-4 mt-1 space-y-0.5 border-l-2 border-base-300 pl-3">
                        {% for page in category_pages %}
                        <li>
                            {% if page.id == current_page.id %}
                                <!-- Current page -->
                                <div class="text-primary font-medium text-sm py-1 cursor-default flex items-center gap-1.5">
                                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-3 h-3 flex-shrink-0">
                                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z" clip-rule="evenodd" />
                                    </svg>
                                    <span class="truncate">{{ page.title }}</span>
                                </div>
                            {% else %}
                                <!-- Other pages -->
                                <a href="{% pageurl page %}" class="text-base-content/60 hover:text-primary text-sm py-1 flex items-center gap-1.5">
                                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20" stroke-width="2" stroke="currentColor" class="w-3 h-3 flex-shrink-0">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5" />
                                    </svg>
                                    <span class="truncate">{{ page.title }}</span>
                                </a>
                            {% endif %}
                        </li>
                        {% endfor %}
                    </ul>
                    {% endif %}
                </li>
                {% endfor %}
            </ul>
        </nav> {% endcomment %}

                    <!-- Table of Contents -->

    </div>
</div>
